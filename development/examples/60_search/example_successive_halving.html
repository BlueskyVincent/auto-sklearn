<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Successive Halving &#8212; AutoSklearn 0.14.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>
  
  <a href="https://github.com/automl/auto-sklearn"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          auto-sklearn</a>
        <span class="navbar-text navbar-version pull-left"><b>0.14.6</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../index.html">Start</a></li>
                <li><a href="../../releases.html">Releases</a></li>
                <li><a href="../../installation.html">Installation</a></li>
                <li><a href="../../manual.html">Manual</a></li>
                <li><a href="../index.html">Examples</a></li>
                <li><a href="../../api.html">API</a></li>
                <li><a href="../../extending.html">Extending</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Successive Halving</a><ul>
<li><a class="reference internal" href="#define-a-callback-that-instantiates-successivehalving">Define a callback that instantiates SuccessiveHalving</a></li>
<li><a class="reference internal" href="#data-loading">Data Loading</a></li>
<li><a class="reference internal" href="#build-and-fit-a-classifier">Build and fit a classifier</a></li>
<li><a class="reference internal" href="#we-can-also-use-cross-validation-with-successive-halving">We can also use cross-validation with successive halving</a></li>
<li><a class="reference internal" href="#use-an-iterative-fit-cross-validation-with-successive-halving">Use an iterative fit cross-validation with successive halving</a></li>
<li><a class="reference internal" href="#next-we-see-the-use-of-subsampling-as-a-budget-in-auto-sklearn">Next, we see the use of subsampling as a budget in Auto-sklearn</a></li>
<li><a class="reference internal" href="#mixed-budget-approach">Mixed budget approach</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-60-search-example-successive-halving-py"><span class="std std-ref">here</span></a>
to download the full example code or to run this example in your browser via Binder</p>
</div>
<div class="sphx-glr-example-title section" id="successive-halving">
<span id="sphx-glr-examples-60-search-example-successive-halving-py"></span><h1>Successive Halving<a class="headerlink" href="#successive-halving" title="Permalink to this headline">¶</a></h1>
<p>This advanced  example illustrates how to interact with
the SMAC callback and get relevant information from the run, like
the number of iterations. Particularly, it exemplifies how to select
the intensification strategy to use in smac, in this case:
<a class="reference external" href="http://proceedings.mlr.press/v80/falkner18a/falkner18a-supp.pdf">SuccessiveHalving</a>.</p>
<p>This results in an adaptation of the <a class="reference external" href="http://proceedings.mlr.press/v80/falkner18a/falkner18a.pdf">BOHB algorithm</a>.
It uses Successive Halving instead of <a class="reference external" href="https://jmlr.org/papers/volume18/16-558/16-558.pdf">Hyperband</a>, and could be abbreviated as BOSH.
To get the BOHB algorithm, simply import Hyperband and use it as the intensification strategy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="kn">import</span> <span class="nn">sklearn.model_selection</span>
<span class="kn">import</span> <span class="nn">sklearn.datasets</span>
<span class="kn">import</span> <span class="nn">sklearn.metrics</span>

<span class="kn">import</span> <span class="nn">autosklearn.classification</span>
</pre></div>
</div>
<div class="section" id="define-a-callback-that-instantiates-successivehalving">
<h2>Define a callback that instantiates SuccessiveHalving<a class="headerlink" href="#define-a-callback-that-instantiates-successivehalving" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_smac_object_callback</span><span class="p">(</span><span class="n">budget_type</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_smac_object</span><span class="p">(</span>
        <span class="n">scenario_dict</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">,</span>
        <span class="n">ta</span><span class="p">,</span>
        <span class="n">ta_kwargs</span><span class="p">,</span>
        <span class="n">metalearning_configurations</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">dask_client</span><span class="p">,</span>
        <span class="n">multi_objective_algorithm</span><span class="p">,</span>  <span class="c1"># This argument will be ignored as SH does not yet support multi-objective optimization</span>
        <span class="n">multi_objective_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="kn">from</span> <span class="nn">smac.facade.smac_ac_facade</span> <span class="kn">import</span> <span class="n">SMAC4AC</span>
        <span class="kn">from</span> <span class="nn">smac.intensification.successive_halving</span> <span class="kn">import</span> <span class="n">SuccessiveHalving</span>
        <span class="kn">from</span> <span class="nn">smac.runhistory.runhistory2epm</span> <span class="kn">import</span> <span class="n">RunHistory2EPM4LogCost</span>
        <span class="kn">from</span> <span class="nn">smac.scenario.scenario</span> <span class="kn">import</span> <span class="n">Scenario</span>

        <span class="k">if</span> <span class="n">n_jobs</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dask_client</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">dask_client</span><span class="o">.</span><span class="n">nthreads</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Please make sure to guard the code invoking Auto-sklearn by &quot;</span>
                <span class="s2">&quot;`if __name__ == &#39;__main__&#39;` and remove this exception.&quot;</span>
            <span class="p">)</span>

        <span class="n">scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="n">scenario_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">metalearning_configurations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">default_config</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">get_default_configuration</span><span class="p">()</span>
            <span class="n">initial_configurations</span> <span class="o">=</span> <span class="p">[</span><span class="n">default_config</span><span class="p">]</span> <span class="o">+</span> <span class="n">metalearning_configurations</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initial_configurations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">rh2EPM</span> <span class="o">=</span> <span class="n">RunHistory2EPM4LogCost</span>

        <span class="n">ta_kwargs</span><span class="p">[</span><span class="s2">&quot;budget_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">budget_type</span>

        <span class="k">return</span> <span class="n">SMAC4AC</span><span class="p">(</span>
            <span class="n">scenario</span><span class="o">=</span><span class="n">scenario</span><span class="p">,</span>
            <span class="n">rng</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="n">runhistory2epm</span><span class="o">=</span><span class="n">rh2EPM</span><span class="p">,</span>
            <span class="n">tae_runner</span><span class="o">=</span><span class="n">ta</span><span class="p">,</span>
            <span class="n">tae_runner_kwargs</span><span class="o">=</span><span class="n">ta_kwargs</span><span class="p">,</span>
            <span class="n">initial_configurations</span><span class="o">=</span><span class="n">initial_configurations</span><span class="p">,</span>
            <span class="n">run_id</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="n">intensifier</span><span class="o">=</span><span class="n">SuccessiveHalving</span><span class="p">,</span>
            <span class="n">intensifier_kwargs</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;initial_budget&quot;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
                <span class="s2">&quot;max_budget&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                <span class="s2">&quot;eta&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;min_chall&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
            <span class="n">dask_client</span><span class="o">=</span><span class="n">dask_client</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">get_smac_object</span>
</pre></div>
</div>
</div>
<div class="section" id="data-loading">
<h2>Data Loading<a class="headerlink" href="#data-loading" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="build-and-fit-a-classifier">
<h2>Build and fit a classifier<a class="headerlink" href="#build-and-fit-a-classifier" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/autosklearn_sh_example_tmp&quot;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># &#39;holdout&#39; with &#39;train_size&#39;=0.67 is the default argument setting</span>
    <span class="c1"># for AutoSklearnClassifier. It is explicitly specified in this example</span>
    <span class="c1"># for demonstrational purpose.</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s2">&quot;holdout&quot;</span><span class="p">,</span>
    <span class="n">resampling_strategy_arguments</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train_size&quot;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">},</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;classifier&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;extra_trees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gradient_boosting&quot;</span><span class="p">,</span>
            <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;passive_aggressive&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;feature_preprocessor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;no_preprocessing&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s2">&quot;iterations&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;breast_cancer&quot;</span><span class="p">)</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/auto-sklearn/auto-sklearn/autosklearn/metalearning/metalearning/meta_base.py:76: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  self.metafeatures = self.metafeatures.append(metafeatures)
/home/runner/work/auto-sklearn/auto-sklearn/autosklearn/metalearning/metalearning/meta_base.py:80: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  self.algorithm_runs[metric].append(runs)
/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:153: UserWarning: SuccessiveHalving is executed with 1 workers only. Consider to use pynisher to use all available workers.
  warnings.warn(
{   2: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb32feac0&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb4fc6bb0&gt;,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb32fe070&gt;,
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 1,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
    3: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcafd1bee0&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb53d9e50&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcafd1b520&gt;,
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 2,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
    4: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaa5ee670&gt;,
           &#39;cost&#39;: 0.07801418439716312,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb2ec8220&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaa5eeca0&gt;,
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 3,
           &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
    5: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb3590550&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf40a760&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb3590220&gt;,
           &#39;model_id&#39;: 5,
           &#39;rank&#39;: 4,
           &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
    6: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaf375460&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb01ca790&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaf375e20&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
    8: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcafe22340&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb05df040&gt;,
           &#39;ensemble_weight&#39;: 0.12,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb30f2f10&gt;,
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 9,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=512, n_jobs=1,
                       random_state=1, warm_start=True)},
    9: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb0a10d00&gt;,
           &#39;cost&#39;: 0.014184397163120588,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf237700&gt;,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb0a10c10&gt;,
           &#39;model_id&#39;: 9,
           &#39;rank&#39;: 10,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=64, n_jobs=1, random_state=1,
                     warm_start=True)},
    11: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaf1f0610&gt;,
            &#39;cost&#39;: 0.014184397163120588,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaeeb18e0&gt;,
            &#39;ensemble_weight&#39;: 0.06,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb5083880&gt;,
            &#39;model_id&#39;: 11,
            &#39;rank&#39;: 14,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False,
                               l2_regularization=1.0945814167023392e-10,
                               learning_rate=0.11042628136263043, max_iter=512,
                               max_leaf_nodes=30, min_samples_leaf=22,
                               n_iter_no_change=0, random_state=1,
                               validation_fraction=None, warm_start=True)},
    12: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efca58bd700&gt;,
            &#39;cost&#39;: 0.04255319148936165,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf5f22b0&gt;,
            &#39;ensemble_weight&#39;: 0.06,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efca58bdd00&gt;,
            &#39;model_id&#39;: 12,
            &#39;rank&#39;: 15,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=1, min_samples_leaf=6,
                       min_samples_split=13, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
    13: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaeb4c640&gt;,
            &#39;cost&#39;: 0.03546099290780147,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaebb8700&gt;,
            &#39;ensemble_weight&#39;: 0.06,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaeb4c550&gt;,
            &#39;model_id&#39;: 13,
            &#39;rank&#39;: 16,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=2.506856350040198e-06,
                               learning_rate=0.04634380160611007, max_iter=64,
                               max_leaf_nodes=11, min_samples_leaf=41,
                               n_iter_no_change=17, random_state=1,
                               validation_fraction=None, warm_start=True)},
    14: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb500cf10&gt;,
            &#39;cost&#39;: 0.03546099290780147,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcafe3b3a0&gt;,
            &#39;ensemble_weight&#39;: 0.08,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb500c580&gt;,
            &#39;model_id&#39;: 14,
            &#39;rank&#39;: 17,
            &#39;sklearn_classifier&#39;: ExtraTreesClassifier(bootstrap=True, max_features=3, min_samples_leaf=2,
                     min_samples_split=3, n_estimators=64, n_jobs=1,
                     random_state=1, warm_start=True)},
    17: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb27ce730&gt;,
            &#39;cost&#39;: 0.099290780141844,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb0fff130&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb27ce910&gt;,
            &#39;model_id&#39;: 17,
            &#39;rank&#39;: 18,
            &#39;sklearn_classifier&#39;: SGDClassifier(alpha=9.410144741041167e-05, average=True,
              eta0=0.0018055343233337954, learning_rate=&#39;constant&#39;, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=0.05082904256838701, warm_start=True)},
    18: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaef787f0&gt;,
            &#39;cost&#39;: 0.05673758865248224,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb4ce9af0&gt;,
            &#39;ensemble_weight&#39;: 0.02,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaef78c70&gt;,
            &#39;model_id&#39;: 18,
            &#39;rank&#39;: 19,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=10,
                       min_samples_leaf=14, min_samples_split=14,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
    19: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb501c7f0&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf33f580&gt;,
            &#39;ensemble_weight&#39;: 0.06,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb501c850&gt;,
            &#39;model_id&#39;: 19,
            &#39;rank&#39;: 20,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=13,
                       min_samples_leaf=13, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.985816
  Number of target algorithm runs: 25
  Number of successful target algorithm runs: 25
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 0
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.951048951048951
</pre></div>
</div>
</div>
<div class="section" id="we-can-also-use-cross-validation-with-successive-halving">
<h2>We can also use cross-validation with successive halving<a class="headerlink" href="#we-can-also-use-cross-validation-with-successive-halving" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/autosklearn_sh_example_tmp_01&quot;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s2">&quot;cv&quot;</span><span class="p">,</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;classifier&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;extra_trees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gradient_boosting&quot;</span><span class="p">,</span>
            <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;passive_aggressive&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;feature_preprocessor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;no_preprocessing&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s2">&quot;iterations&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;breast_cancer&quot;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">refit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/auto-sklearn/auto-sklearn/autosklearn/metalearning/metalearning/meta_base.py:76: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  self.metafeatures = self.metafeatures.append(metafeatures)
/home/runner/work/auto-sklearn/auto-sklearn/autosklearn/metalearning/metalearning/meta_base.py:80: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  self.algorithm_runs[metric].append(runs)
/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:153: UserWarning: SuccessiveHalving is executed with 1 workers only. Consider to use pynisher to use all available workers.
  warnings.warn(
{   2: {   &#39;cost&#39;: 0.046948356807511755,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efca5940460&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb4f4be50&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efca59409d0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaebc53d0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb28f3ee0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaebc5580&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaeeb1cd0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf2968b0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaeeb1940&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb059f760&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb0a908b0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb059fb20&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaf018670&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaff310d0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaf018370&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)}],
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 1,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    3: {   &#39;cost&#39;: 0.05164319248826292,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb2832c10&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb068b640&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb2832be0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb30f4430&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb2961850&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb30f49d0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb2a463d0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb30f2c70&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb3540520&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaf865fd0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb0138790&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaf865f10&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcac0be880&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf0bdfa0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcac0be310&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)}],
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 2,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    4: {   &#39;cost&#39;: 0.08215962441314555,
           &#39;ensemble_weight&#39;: 0.28,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb4ff0640&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb01ede20&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb511ce50&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb0ead4c0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcafe22340&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb0ead250&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaf0bd0a0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb29583d0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaf0bd130&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb3590c70&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb3381100&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb3590190&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb0eab6a0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb32f0e80&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb0eab250&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)}],
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 3,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    7: {   &#39;cost&#39;: 0.035211267605633784,
           &#39;ensemble_weight&#39;: 0.1,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb299ec40&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efca5940700&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb299e0d0&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb0ecc460&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf237dc0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb0ecce80&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaa3994c0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb32f0280&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaa3992e0&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb01cacd0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb5073e20&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb01ca8e0&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcafcbdf10&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb29f12e0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcafcbdcd0&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)}],
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 4,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    8: {   &#39;cost&#39;: 0.039906103286385,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaf0e3e80&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaebb8310&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaf0e36d0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb01ca580&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf40a9a0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb01cae50&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efca590fd00&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efca8d69430&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcafa74250&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcc858f130&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcab1913a0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcc858f160&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb2d5e400&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaebe02b0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb2d5e340&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)}],
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 5,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    9: {   &#39;cost&#39;: 0.030516431924882622,
           &#39;ensemble_weight&#39;: 0.24,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb30ec9d0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb088a9d0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efca8d33940&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=256, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb31ad070&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb2e80640&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb31bdbb0&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=256, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcac2bf3d0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb28c5b20&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcac2bf310&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=256, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb2ebb160&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf3b9b50&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb2ebb0a0&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=256, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaf359340&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaea30d30&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaf359280&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=256, n_jobs=1, random_state=1,
                     warm_start=True)}],
           &#39;model_id&#39;: 9,
           &#39;rank&#39;: 8,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.971831
  Number of target algorithm runs: 11
  Number of successful target algorithm runs: 10
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 1
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.965034965034965
</pre></div>
</div>
</div>
<div class="section" id="use-an-iterative-fit-cross-validation-with-successive-halving">
<h2>Use an iterative fit cross-validation with successive halving<a class="headerlink" href="#use-an-iterative-fit-cross-validation-with-successive-halving" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/autosklearn_sh_example_tmp_cv_02&quot;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s2">&quot;cv-iterative-fit&quot;</span><span class="p">,</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;classifier&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;extra_trees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gradient_boosting&quot;</span><span class="p">,</span>
            <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;passive_aggressive&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;feature_preprocessor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;no_preprocessing&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s2">&quot;iterations&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;breast_cancer&quot;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">refit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/auto-sklearn/auto-sklearn/autosklearn/metalearning/metalearning/meta_base.py:76: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  self.metafeatures = self.metafeatures.append(metafeatures)
/home/runner/work/auto-sklearn/auto-sklearn/autosklearn/metalearning/metalearning/meta_base.py:80: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  self.algorithm_runs[metric].append(runs)
/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:153: UserWarning: SuccessiveHalving is executed with 1 workers only. Consider to use pynisher to use all available workers.
  warnings.warn(
{   2: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaee80e80&gt;,
           &#39;cost&#39;: 0.046948356807511755,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaee803a0&gt;,
           &#39;ensemble_weight&#39;: 0.16,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaee809a0&gt;,
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 1,
           &#39;sklearn_classifier&#39;: None},
    3: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb2ec8b50&gt;,
           &#39;cost&#39;: 0.05164319248826292,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcac53a910&gt;,
           &#39;ensemble_weight&#39;: 0.18,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaf1561f0&gt;,
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 2,
           &#39;sklearn_classifier&#39;: None},
    4: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb4ebea60&gt;,
           &#39;cost&#39;: 0.11267605633802817,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb01caa60&gt;,
           &#39;ensemble_weight&#39;: 0.16,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb4ebeac0&gt;,
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 3,
           &#39;sklearn_classifier&#39;: None},
    5: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efca9a509a0&gt;,
           &#39;cost&#39;: 0.035211267605633804,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaee80250&gt;,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efca9a507c0&gt;,
           &#39;model_id&#39;: 5,
           &#39;rank&#39;: 4,
           &#39;sklearn_classifier&#39;: None},
    6: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb02b1b20&gt;,
           &#39;cost&#39;: 0.04694835680751174,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb30ecc40&gt;,
           &#39;ensemble_weight&#39;: 0.14,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaa96ef10&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: None},
    7: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb4e9c3d0&gt;,
           &#39;cost&#39;: 0.03286384976525822,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf156d00&gt;,
           &#39;ensemble_weight&#39;: 0.22,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb4e9caf0&gt;,
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 6,
           &#39;sklearn_classifier&#39;: None},
    8: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb25a00a0&gt;,
           &#39;cost&#39;: 0.04225352112676056,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaa5ee310&gt;,
           &#39;ensemble_weight&#39;: 0.12,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb0b3c9a0&gt;,
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 7,
           &#39;sklearn_classifier&#39;: None}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.967136
  Number of target algorithm runs: 7
  Number of successful target algorithm runs: 7
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 0
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.965034965034965
</pre></div>
</div>
</div>
<div class="section" id="next-we-see-the-use-of-subsampling-as-a-budget-in-auto-sklearn">
<h2>Next, we see the use of subsampling as a budget in Auto-sklearn<a class="headerlink" href="#next-we-see-the-use-of-subsampling-as-a-budget-in-auto-sklearn" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/autosklearn_sh_example_tmp_03&quot;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># &#39;holdout&#39; with &#39;train_size&#39;=0.67 is the default argument setting</span>
    <span class="c1"># for AutoSklearnClassifier. It is explicitly specified in this example</span>
    <span class="c1"># for demonstrational purpose.</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s2">&quot;holdout&quot;</span><span class="p">,</span>
    <span class="n">resampling_strategy_arguments</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train_size&quot;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s2">&quot;subsample&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;breast_cancer&quot;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/auto-sklearn/auto-sklearn/autosklearn/metalearning/metalearning/meta_base.py:76: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  self.metafeatures = self.metafeatures.append(metafeatures)
/home/runner/work/auto-sklearn/auto-sklearn/autosklearn/metalearning/metalearning/meta_base.py:80: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  self.algorithm_runs[metric].append(runs)
/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:153: UserWarning: SuccessiveHalving is executed with 1 workers only. Consider to use pynisher to use all available workers.
  warnings.warn(
{   2: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaf3e7f70&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcac682a60&gt;,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaf3e7640&gt;,
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 1,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=512, n_jobs=1,
                       random_state=1, warm_start=True)},
    3: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaeaa2f40&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efca9a3f100&gt;,
           &#39;ensemble_weight&#39;: 0.12,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb30e0970&gt;,
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 2,
           &#39;sklearn_classifier&#39;: MLPClassifier(activation=&#39;tanh&#39;, alpha=0.0001363185819149026, beta_1=0.999,
              beta_2=0.9, early_stopping=True,
              hidden_layer_sizes=(115, 115, 115),
              learning_rate_init=0.00018009776276177523, max_iter=32,
              n_iter_no_change=32, random_state=1, verbose=0, warm_start=True)},
    4: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efca8d69a90&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcafa74af0&gt;,
           &#39;ensemble_weight&#39;: 0.1,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efca8d691c0&gt;,
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 3,
           &#39;sklearn_classifier&#39;: MLPClassifier(activation=&#39;tanh&#39;, alpha=0.00021148999718383549, beta_1=0.999,
              beta_2=0.9, hidden_layer_sizes=(113, 113, 113),
              learning_rate_init=0.0007452270241186694, max_iter=32,
              n_iter_no_change=32, random_state=1, validation_fraction=0.0,
              verbose=0, warm_start=True)},
    5: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaeeb1d30&gt;,
           &#39;cost&#39;: 0.03546099290780147,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb4fc6670&gt;,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb08ffe50&gt;,
           &#39;model_id&#39;: 5,
           &#39;rank&#39;: 4,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=3, min_samples_leaf=2,
                       n_estimators=512, n_jobs=1, random_state=1,
                       warm_start=True)},
    6: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb0499130&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efca9a6f550&gt;,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaebc51f0&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: MLPClassifier(alpha=0.0017940473175767063, beta_1=0.999, beta_2=0.9,
              early_stopping=True, hidden_layer_sizes=(101, 101),
              learning_rate_init=0.0004684917334431039, max_iter=32,
              n_iter_no_change=32, random_state=1, verbose=0, warm_start=True)},
    7: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb059f1c0&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb30fe880&gt;,
           &#39;ensemble_weight&#39;: 0.12,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcafea28b0&gt;,
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 6,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(max_features=34, min_samples_leaf=3, min_samples_split=11,
                     n_estimators=512, n_jobs=1, random_state=1,
                     warm_start=True)},
    8: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efca58bd5e0&gt;,
           &#39;cost&#39;: 0.03546099290780147,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb3382370&gt;,
           &#39;ensemble_weight&#39;: 0.08,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcafe22e20&gt;,
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 10,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=2, min_samples_leaf=2, n_estimators=512,
                       n_jobs=1, random_state=1, warm_start=True)},
    9: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb3590730&gt;,
           &#39;cost&#39;: 0.07801418439716312,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb3540790&gt;,
           &#39;ensemble_weight&#39;: 0.08,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb32fe100&gt;,
           &#39;model_id&#39;: 9,
           &#39;rank&#39;: 11,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(max_features=6, min_samples_split=10, n_estimators=512,
                     n_jobs=1, random_state=1, warm_start=True)},
    10: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcabacccd0&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb0b3c460&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcabacc190&gt;,
            &#39;model_id&#39;: 10,
            &#39;rank&#39;: 12,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=4, min_samples_split=6,
                       n_estimators=512, n_jobs=1, random_state=1,
                       warm_start=True)},
    11: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcac9a2910&gt;,
            &#39;cost&#39;: 0.05673758865248224,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb4d2f0a0&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcac9a2760&gt;,
            &#39;model_id&#39;: 11,
            &#39;rank&#39;: 13,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=512, n_jobs=1, random_state=1,
                       warm_start=True)},
    12: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaee80f40&gt;,
            &#39;cost&#39;: 0.03546099290780147,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb0eab9a0&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaee80910&gt;,
            &#39;model_id&#39;: 12,
            &#39;rank&#39;: 14,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=0.005326508887463406,
                               learning_rate=0.060800813211425456, max_iter=512,
                               max_leaf_nodes=6, min_samples_leaf=5,
                               n_iter_no_change=5, random_state=1,
                               validation_fraction=None, warm_start=True)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.978723
  Number of target algorithm runs: 16
  Number of successful target algorithm runs: 15
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 1
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.9440559440559441
</pre></div>
</div>
</div>
<div class="section" id="mixed-budget-approach">
<h2>Mixed budget approach<a class="headerlink" href="#mixed-budget-approach" title="Permalink to this headline">¶</a></h2>
<p>Finally, there’s a mixed budget type which uses iterations where possible and
subsamples otherwise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/autosklearn_sh_example_tmp_04&quot;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># &#39;holdout&#39; with &#39;train_size&#39;=0.67 is the default argument setting</span>
    <span class="c1"># for AutoSklearnClassifier. It is explicitly specified in this example</span>
    <span class="c1"># for demonstrational purpose.</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s2">&quot;holdout&quot;</span><span class="p">,</span>
    <span class="n">resampling_strategy_arguments</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train_size&quot;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">},</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;classifier&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;extra_trees&quot;</span><span class="p">,</span> <span class="s2">&quot;gradient_boosting&quot;</span><span class="p">,</span> <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span> <span class="s2">&quot;sgd&quot;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s2">&quot;mixed&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;breast_cancer&quot;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/auto-sklearn/auto-sklearn/autosklearn/metalearning/metalearning/meta_base.py:76: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  self.metafeatures = self.metafeatures.append(metafeatures)
/home/runner/work/auto-sklearn/auto-sklearn/autosklearn/metalearning/metalearning/meta_base.py:80: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  self.algorithm_runs[metric].append(runs)
/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:153: UserWarning: SuccessiveHalving is executed with 1 workers only. Consider to use pynisher to use all available workers.
  warnings.warn(
{   2: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb2f8b940&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcafd1b700&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb2f8b070&gt;,
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 1,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
    4: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb3066e20&gt;,
           &#39;cost&#39;: 0.014184397163120588,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb4ea7d30&gt;,
           &#39;ensemble_weight&#39;: 0.16,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb3066d60&gt;,
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(max_features=34, min_samples_leaf=3, min_samples_split=11,
                     n_estimators=512, n_jobs=1, random_state=1,
                     warm_start=True)},
    6: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb01382b0&gt;,
           &#39;cost&#39;: 0.04255319148936165,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb500c6a0&gt;,
           &#39;ensemble_weight&#39;: 0.08,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcaf375dc0&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 6,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(max_features=9, min_samples_split=10, n_estimators=64,
                     n_jobs=1, random_state=1, warm_start=True)},
    9: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcaff31be0&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb4e33d90&gt;,
           &#39;ensemble_weight&#39;: 0.08,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efca99661c0&gt;,
           &#39;model_id&#39;: 9,
           &#39;rank&#39;: 7,
           &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=0.005326508887463406,
                               learning_rate=0.060800813211425456, max_iter=64,
                               max_leaf_nodes=6, min_samples_leaf=5,
                               n_iter_no_change=5, random_state=1,
                               validation_fraction=None, warm_start=True)},
    11: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efca9a2c940&gt;,
            &#39;cost&#39;: 0.021276595744680882,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcaf2373a0&gt;,
            &#39;ensemble_weight&#39;: 0.06,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efca9a2c8e0&gt;,
            &#39;model_id&#39;: 11,
            &#39;rank&#39;: 9,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.387912939529945e-10,
                               learning_rate=0.30755227194768237, max_iter=128,
                               max_leaf_nodes=60, min_samples_leaf=39,
                               n_iter_no_change=18, random_state=1,
                               validation_fraction=None, warm_start=True)},
    14: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb50831f0&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efca590fd60&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb50834f0&gt;,
            &#39;model_id&#39;: 14,
            &#39;rank&#39;: 10,
            &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=448, min_samples_leaf=2,
                     min_samples_split=20, n_estimators=64, n_jobs=1,
                     random_state=1, warm_start=True)},
    16: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcafea24f0&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcb0d53ee0&gt;,
            &#39;ensemble_weight&#39;: 0.06,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcafcbd190&gt;,
            &#39;model_id&#39;: 16,
            &#39;rank&#39;: 11,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=8.057778875694463e-05,
                               learning_rate=0.09179220974965213, max_iter=64,
                               max_leaf_nodes=200, n_iter_no_change=18,
                               random_state=1,
                               validation_fraction=0.14295295806077554,
                               warm_start=True)},
    19: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7efcb2879bb0&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7efcac6829a0&gt;,
            &#39;ensemble_weight&#39;: 0.06,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7efcb2879a00&gt;,
            &#39;model_id&#39;: 19,
            &#39;rank&#39;: 12,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.985816
  Number of target algorithm runs: 24
  Number of successful target algorithm runs: 24
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 0
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.951048951048951
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 3 minutes  9.372 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-60-search-example-successive-halving-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/automl/auto-sklearn/master?urlpath=lab/tree/notebooks/examples/60_search/example_successive_halving.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo2.svg" width="150px" /></a>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/54625156807f9d21fa14b78034b1df5c/example_successive_halving.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">example_successive_halving.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ce2e8ffc7b9780e0d18638781ffd952b/example_successive_halving.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">example_successive_halving.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/examples/60_search/example_successive_halving.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2014-2022, Machine Learning Professorship Freiburg.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Successive Halving &#8212; AutoSklearn 0.14.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>
  
  <a href="https://github.com/automl/auto-sklearn"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          auto-sklearn</a>
        <span class="navbar-text navbar-version pull-left"><b>0.14.6</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../index.html">Start</a></li>
                <li><a href="../../releases.html">Releases</a></li>
                <li><a href="../../installation.html">Installation</a></li>
                <li><a href="../../manual.html">Manual</a></li>
                <li><a href="../index.html">Examples</a></li>
                <li><a href="../../api.html">API</a></li>
                <li><a href="../../extending.html">Extending</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Successive Halving</a><ul>
<li><a class="reference internal" href="#define-a-callback-that-instantiates-successivehalving">Define a callback that instantiates SuccessiveHalving</a></li>
<li><a class="reference internal" href="#data-loading">Data Loading</a></li>
<li><a class="reference internal" href="#build-and-fit-a-classifier">Build and fit a classifier</a></li>
<li><a class="reference internal" href="#we-can-also-use-cross-validation-with-successive-halving">We can also use cross-validation with successive halving</a></li>
<li><a class="reference internal" href="#use-an-iterative-fit-cross-validation-with-successive-halving">Use an iterative fit cross-validation with successive halving</a></li>
<li><a class="reference internal" href="#next-we-see-the-use-of-subsampling-as-a-budget-in-auto-sklearn">Next, we see the use of subsampling as a budget in Auto-sklearn</a></li>
<li><a class="reference internal" href="#mixed-budget-approach">Mixed budget approach</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-60-search-example-successive-halving-py"><span class="std std-ref">here</span></a>
to download the full example code or to run this example in your browser via Binder</p>
</div>
<div class="sphx-glr-example-title section" id="successive-halving">
<span id="sphx-glr-examples-60-search-example-successive-halving-py"></span><h1>Successive Halving<a class="headerlink" href="#successive-halving" title="Permalink to this headline">¶</a></h1>
<p>This advanced  example illustrates how to interact with
the SMAC callback and get relevant information from the run, like
the number of iterations. Particularly, it exemplifies how to select
the intensification strategy to use in smac, in this case:
<a class="reference external" href="http://proceedings.mlr.press/v80/falkner18a/falkner18a-supp.pdf">SuccessiveHalving</a>.</p>
<p>This results in an adaptation of the <a class="reference external" href="http://proceedings.mlr.press/v80/falkner18a/falkner18a.pdf">BOHB algorithm</a>.
It uses Successive Halving instead of <a class="reference external" href="https://jmlr.org/papers/volume18/16-558/16-558.pdf">Hyperband</a>, and could be abbreviated as BOSH.
To get the BOHB algorithm, simply import Hyperband and use it as the intensification strategy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="kn">import</span> <span class="nn">sklearn.model_selection</span>
<span class="kn">import</span> <span class="nn">sklearn.datasets</span>
<span class="kn">import</span> <span class="nn">sklearn.metrics</span>

<span class="kn">import</span> <span class="nn">autosklearn.classification</span>
</pre></div>
</div>
<div class="section" id="define-a-callback-that-instantiates-successivehalving">
<h2>Define a callback that instantiates SuccessiveHalving<a class="headerlink" href="#define-a-callback-that-instantiates-successivehalving" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_smac_object_callback</span><span class="p">(</span><span class="n">budget_type</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_smac_object</span><span class="p">(</span>
        <span class="n">scenario_dict</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">,</span>
        <span class="n">ta</span><span class="p">,</span>
        <span class="n">ta_kwargs</span><span class="p">,</span>
        <span class="n">metalearning_configurations</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">dask_client</span><span class="p">,</span>
        <span class="n">multi_objective_algorithm</span><span class="p">,</span>  <span class="c1"># This argument will be ignored as SH does not yet support multi-objective optimization</span>
        <span class="n">multi_objective_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="kn">from</span> <span class="nn">smac.facade.smac_ac_facade</span> <span class="kn">import</span> <span class="n">SMAC4AC</span>
        <span class="kn">from</span> <span class="nn">smac.intensification.successive_halving</span> <span class="kn">import</span> <span class="n">SuccessiveHalving</span>
        <span class="kn">from</span> <span class="nn">smac.runhistory.runhistory2epm</span> <span class="kn">import</span> <span class="n">RunHistory2EPM4LogCost</span>
        <span class="kn">from</span> <span class="nn">smac.scenario.scenario</span> <span class="kn">import</span> <span class="n">Scenario</span>

        <span class="k">if</span> <span class="n">n_jobs</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dask_client</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">dask_client</span><span class="o">.</span><span class="n">nthreads</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Please make sure to guard the code invoking Auto-sklearn by &quot;</span>
                <span class="s2">&quot;`if __name__ == &#39;__main__&#39;` and remove this exception.&quot;</span>
            <span class="p">)</span>

        <span class="n">scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="n">scenario_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">metalearning_configurations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">default_config</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">get_default_configuration</span><span class="p">()</span>
            <span class="n">initial_configurations</span> <span class="o">=</span> <span class="p">[</span><span class="n">default_config</span><span class="p">]</span> <span class="o">+</span> <span class="n">metalearning_configurations</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initial_configurations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">rh2EPM</span> <span class="o">=</span> <span class="n">RunHistory2EPM4LogCost</span>

        <span class="n">ta_kwargs</span><span class="p">[</span><span class="s2">&quot;budget_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">budget_type</span>

        <span class="k">return</span> <span class="n">SMAC4AC</span><span class="p">(</span>
            <span class="n">scenario</span><span class="o">=</span><span class="n">scenario</span><span class="p">,</span>
            <span class="n">rng</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="n">runhistory2epm</span><span class="o">=</span><span class="n">rh2EPM</span><span class="p">,</span>
            <span class="n">tae_runner</span><span class="o">=</span><span class="n">ta</span><span class="p">,</span>
            <span class="n">tae_runner_kwargs</span><span class="o">=</span><span class="n">ta_kwargs</span><span class="p">,</span>
            <span class="n">initial_configurations</span><span class="o">=</span><span class="n">initial_configurations</span><span class="p">,</span>
            <span class="n">run_id</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="n">intensifier</span><span class="o">=</span><span class="n">SuccessiveHalving</span><span class="p">,</span>
            <span class="n">intensifier_kwargs</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;initial_budget&quot;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
                <span class="s2">&quot;max_budget&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                <span class="s2">&quot;eta&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;min_chall&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
            <span class="n">dask_client</span><span class="o">=</span><span class="n">dask_client</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">get_smac_object</span>
</pre></div>
</div>
</div>
<div class="section" id="data-loading">
<h2>Data Loading<a class="headerlink" href="#data-loading" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="build-and-fit-a-classifier">
<h2>Build and fit a classifier<a class="headerlink" href="#build-and-fit-a-classifier" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/autosklearn_sh_example_tmp&quot;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># &#39;holdout&#39; with &#39;train_size&#39;=0.67 is the default argument setting</span>
    <span class="c1"># for AutoSklearnClassifier. It is explicitly specified in this example</span>
    <span class="c1"># for demonstrational purpose.</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s2">&quot;holdout&quot;</span><span class="p">,</span>
    <span class="n">resampling_strategy_arguments</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train_size&quot;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">},</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;classifier&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;extra_trees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gradient_boosting&quot;</span><span class="p">,</span>
            <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;passive_aggressive&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;feature_preprocessor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;no_preprocessing&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s2">&quot;iterations&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;breast_cancer&quot;</span><span class="p">)</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:153: UserWarning: SuccessiveHalving is executed with 1 workers only. Consider to use pynisher to use all available workers.
  warnings.warn(
{   2: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d54aa60&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7f1a81c0&gt;,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7f1a82b0&gt;,
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 1,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
    4: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d0be790&gt;,
           &#39;cost&#39;: 0.07801418439716312,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d55b820&gt;,
           &#39;ensemble_weight&#39;: 0.1,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d0be400&gt;,
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 2,
           &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
    5: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c74fb04f0&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7f1b70a0&gt;,
           &#39;ensemble_weight&#39;: 0.08,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c74fb0850&gt;,
           &#39;model_id&#39;: 5,
           &#39;rank&#39;: 3,
           &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
    6: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c72e0b2e0&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7bf0a760&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7cd0e6d0&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 4,
           &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
    7: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c962100&gt;,
           &#39;cost&#39;: 0.03546099290780147,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7bdd28e0&gt;,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c962340&gt;,
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
    8: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d6d4280&gt;,
           &#39;cost&#39;: 0.014184397163120588,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d628040&gt;,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d6d4d00&gt;,
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 6,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
    9: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c41bd30&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7c428f40&gt;,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c41bee0&gt;,
           &#39;model_id&#39;: 9,
           &#39;rank&#39;: 10,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=512, n_jobs=1, random_state=1,
                     warm_start=True)},
    11: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c72d8e340&gt;,
            &#39;cost&#39;: 0.014184397163120588,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d2d92e0&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c72d8e9a0&gt;,
            &#39;model_id&#39;: 11,
            &#39;rank&#39;: 14,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False,
                               l2_regularization=1.0945814167023392e-10,
                               learning_rate=0.11042628136263043, max_iter=512,
                               max_leaf_nodes=30, min_samples_leaf=22,
                               n_iter_no_change=0, random_state=1,
                               validation_fraction=None, warm_start=True)},
    12: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c003850&gt;,
            &#39;cost&#39;: 0.04255319148936165,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d11cac0&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c0034f0&gt;,
            &#39;model_id&#39;: 12,
            &#39;rank&#39;: 15,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=1, min_samples_leaf=6,
                       min_samples_split=13, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
    13: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c73f27940&gt;,
            &#39;cost&#39;: 0.03546099290780147,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c78354760&gt;,
            &#39;ensemble_weight&#39;: 0.06,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c73f27520&gt;,
            &#39;model_id&#39;: 13,
            &#39;rank&#39;: 16,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=2.506856350040198e-06,
                               learning_rate=0.04634380160611007, max_iter=64,
                               max_leaf_nodes=11, min_samples_leaf=41,
                               n_iter_no_change=17, random_state=1,
                               validation_fraction=None, warm_start=True)},
    14: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7f065c10&gt;,
            &#39;cost&#39;: 0.03546099290780147,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c741b8340&gt;,
            &#39;ensemble_weight&#39;: 0.02,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7f065fa0&gt;,
            &#39;model_id&#39;: 14,
            &#39;rank&#39;: 17,
            &#39;sklearn_classifier&#39;: ExtraTreesClassifier(bootstrap=True, max_features=3, min_samples_leaf=2,
                     min_samples_split=3, n_estimators=64, n_jobs=1,
                     random_state=1, warm_start=True)},
    16: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c77a83670&gt;,
            &#39;cost&#39;: 0.049645390070921946,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7ce237c0&gt;,
            &#39;ensemble_weight&#39;: 0.02,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c77a83970&gt;,
            &#39;model_id&#39;: 16,
            &#39;rank&#39;: 18,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=12,
                       min_samples_leaf=15, min_samples_split=6,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
    17: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c15ae50&gt;,
            &#39;cost&#39;: 0.099290780141844,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d4585b0&gt;,
            &#39;ensemble_weight&#39;: 0.1,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c15a8e0&gt;,
            &#39;model_id&#39;: 17,
            &#39;rank&#39;: 19,
            &#39;sklearn_classifier&#39;: SGDClassifier(alpha=9.410144741041167e-05, average=True,
              eta0=0.0018055343233337954, learning_rate=&#39;constant&#39;, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=0.05082904256838701, warm_start=True)},
    18: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7f0d5a90&gt;,
            &#39;cost&#39;: 0.05673758865248224,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7bf04460&gt;,
            &#39;ensemble_weight&#39;: 0.02,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7f0d5040&gt;,
            &#39;model_id&#39;: 18,
            &#39;rank&#39;: 20,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=10,
                       min_samples_leaf=14, min_samples_split=14,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
    19: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c740b3820&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7cd0b910&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c740b3f70&gt;,
            &#39;model_id&#39;: 19,
            &#39;rank&#39;: 21,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=13,
                       min_samples_leaf=13, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.985816
  Number of target algorithm runs: 26
  Number of successful target algorithm runs: 26
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 0
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.9440559440559441
</pre></div>
</div>
</div>
<div class="section" id="we-can-also-use-cross-validation-with-successive-halving">
<h2>We can also use cross-validation with successive halving<a class="headerlink" href="#we-can-also-use-cross-validation-with-successive-halving" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/autosklearn_sh_example_tmp_01&quot;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s2">&quot;cv&quot;</span><span class="p">,</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;classifier&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;extra_trees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gradient_boosting&quot;</span><span class="p">,</span>
            <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;passive_aggressive&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;feature_preprocessor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;no_preprocessing&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s2">&quot;iterations&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;breast_cancer&quot;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">refit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:153: UserWarning: SuccessiveHalving is executed with 1 workers only. Consider to use pynisher to use all available workers.
  warnings.warn(
{   2: {   &#39;cost&#39;: 0.046948356807511755,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c741b8e80&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7c0281c0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c741b8fa0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7f19f4f0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c783542e0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c13e190&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7f3f09a0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c73c95460&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7f3f02b0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d306c10&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c77913e20&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d3061f0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c77487310&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c774ac1c0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c774877c0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)}],
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 1,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    3: {   &#39;cost&#39;: 0.05164319248826292,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d0942e0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7f06c070&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d094cd0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7ce45310&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7cfbf0a0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7ce45850&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c72cff850&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c729d2df0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c72cfffa0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c72de88b0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7c426610&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c72de8370&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c76fd60&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7c162fd0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c76fa30&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)}],
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 2,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    4: {   &#39;cost&#39;: 0.08215962441314555,
           &#39;ensemble_weight&#39;: 0.26,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c13e730&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7f197340&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d0cc250&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d574640&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c72ed1ac0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d574490&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c162fa0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c72de8b50&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c162940&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c72e0b670&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7865fbb0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c72e0b6d0&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c78394dc0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d1d8bb0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c78394640&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)}],
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 3,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    5: {   &#39;cost&#39;: 0.035211267605633804,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7534e220&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c741b87f0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7534eee0&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c72e26220&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7bf62280&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c72e26f40&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7bdb7a30&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7bf371f0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7bdb7df0&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7f1b7580&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7cad6c10&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7f1b7130&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c72e7c0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d54a040&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c72ee20&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)}],
           &#39;model_id&#39;: 5,
           &#39;rank&#39;: 4,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    6: {   &#39;cost&#39;: 0.04694835680751174,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c72d70340&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d094610&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c72d70100&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d0bed30&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c78354820&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d0be100&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c740b3af0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7c1fdb50&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c740b3a30&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c90d640&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7f0d5400&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c90dbe0&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c74b13370&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d63fee0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d234a60&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)}],
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 5,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    7: {   &#39;cost&#39;: 0.035211267605633784,
           &#39;ensemble_weight&#39;: 0.14,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c77a13670&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7f0a88b0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c77a13040&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7f0d5700&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c741448e0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c73b37520&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c729237f0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d63f070&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c729230d0&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d3cb100&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7ef2f370&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d3cb7c0&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7beec5e0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7cc154c0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7beec520&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)}],
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 6,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    8: {   &#39;cost&#39;: 0.039906103286385,
           &#39;ensemble_weight&#39;: 0.14,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7f156b80&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7534eb80&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7f156d30&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c73ceb280&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d043370&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c73cebf70&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7388f820&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c72fbe1f0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7388f760&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c740e24f0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c72e3fe50&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c740e2430&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c714280&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c730a2be0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c7141c0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)}],
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 7,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    9: {   &#39;cost&#39;: 0.030516431924882622,
           &#39;ensemble_weight&#39;: 0.08,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c78386b50&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7f1b7fd0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c78386910&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=256, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c74332d90&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c6f4daf70&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c74332ca0&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=256, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7280ed60&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c73931a60&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7280eca0&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=256, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c728f7ca0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7c897700&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c728f7be0&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=256, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c760d0100&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c77937a90&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c73ddcf70&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=256, n_jobs=1, random_state=1,
                     warm_start=True)}],
           &#39;model_id&#39;: 9,
           &#39;rank&#39;: 10,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)}}
/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/sklearn/impute/_base.py:49: FutureWarning: Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.
  mode = stats.mode(array)
/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/sklearn/impute/_base.py:49: FutureWarning: Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.
  mode = stats.mode(array)
/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/sklearn/impute/_base.py:49: FutureWarning: Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.
  mode = stats.mode(array)
/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/sklearn/impute/_base.py:49: FutureWarning: Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.
  mode = stats.mode(array)
/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/sklearn/impute/_base.py:49: FutureWarning: Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.
  mode = stats.mode(array)
/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/sklearn/impute/_base.py:49: FutureWarning: Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.
  mode = stats.mode(array)
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.971831
  Number of target algorithm runs: 11
  Number of successful target algorithm runs: 10
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 1
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.965034965034965
</pre></div>
</div>
</div>
<div class="section" id="use-an-iterative-fit-cross-validation-with-successive-halving">
<h2>Use an iterative fit cross-validation with successive halving<a class="headerlink" href="#use-an-iterative-fit-cross-validation-with-successive-halving" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/autosklearn_sh_example_tmp_cv_02&quot;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s2">&quot;cv-iterative-fit&quot;</span><span class="p">,</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;classifier&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;extra_trees&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gradient_boosting&quot;</span><span class="p">,</span>
            <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;passive_aggressive&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;feature_preprocessor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;no_preprocessing&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s2">&quot;iterations&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;breast_cancer&quot;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">refit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:153: UserWarning: SuccessiveHalving is executed with 1 workers only. Consider to use pynisher to use all available workers.
  warnings.warn(
{   2: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d043520&gt;,
           &#39;cost&#39;: 0.046948356807511755,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d043700&gt;,
           &#39;ensemble_weight&#39;: 0.22,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d043100&gt;,
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 1,
           &#39;sklearn_classifier&#39;: None},
    3: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7855fa60&gt;,
           &#39;cost&#39;: 0.05164319248826292,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c73b37a90&gt;,
           &#39;ensemble_weight&#39;: 0.12,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c74144550&gt;,
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 2,
           &#39;sklearn_classifier&#39;: None},
    4: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c73ad88b0&gt;,
           &#39;cost&#39;: 0.11267605633802817,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c73b37cd0&gt;,
           &#39;ensemble_weight&#39;: 0.26,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c73ad8b50&gt;,
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 3,
           &#39;sklearn_classifier&#39;: None},
    5: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c777703d0&gt;,
           &#39;cost&#39;: 0.035211267605633804,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d043910&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7f0d5940&gt;,
           &#39;model_id&#39;: 5,
           &#39;rank&#39;: 4,
           &#39;sklearn_classifier&#39;: None},
    6: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c740cbe20&gt;,
           &#39;cost&#39;: 0.04694835680751174,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d60ae80&gt;,
           &#39;ensemble_weight&#39;: 0.1,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c740cb730&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: None},
    7: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d234250&gt;,
           &#39;cost&#39;: 0.03286384976525822,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7c90d490&gt;,
           &#39;ensemble_weight&#39;: 0.14,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d234070&gt;,
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 6,
           &#39;sklearn_classifier&#39;: None},
    8: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7f156100&gt;,
           &#39;cost&#39;: 0.039906103286385,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c73cdb760&gt;,
           &#39;ensemble_weight&#39;: 0.12,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7f156670&gt;,
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 7,
           &#39;sklearn_classifier&#39;: None}}
/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/sklearn/impute/_base.py:49: FutureWarning: Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.
  mode = stats.mode(array)
/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/sklearn/impute/_base.py:49: FutureWarning: Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.
  mode = stats.mode(array)
/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/sklearn/impute/_base.py:49: FutureWarning: Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.
  mode = stats.mode(array)
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.967136
  Number of target algorithm runs: 7
  Number of successful target algorithm runs: 7
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 0
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.958041958041958
</pre></div>
</div>
</div>
<div class="section" id="next-we-see-the-use-of-subsampling-as-a-budget-in-auto-sklearn">
<h2>Next, we see the use of subsampling as a budget in Auto-sklearn<a class="headerlink" href="#next-we-see-the-use-of-subsampling-as-a-budget-in-auto-sklearn" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/autosklearn_sh_example_tmp_03&quot;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># &#39;holdout&#39; with &#39;train_size&#39;=0.67 is the default argument setting</span>
    <span class="c1"># for AutoSklearnClassifier. It is explicitly specified in this example</span>
    <span class="c1"># for demonstrational purpose.</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s2">&quot;holdout&quot;</span><span class="p">,</span>
    <span class="n">resampling_strategy_arguments</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train_size&quot;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s2">&quot;subsample&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;breast_cancer&quot;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:153: UserWarning: SuccessiveHalving is executed with 1 workers only. Consider to use pynisher to use all available workers.
  warnings.warn(
{   3: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d6b9b80&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7f0b04c0&gt;,
           &#39;ensemble_weight&#39;: 0.3,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d6b9460&gt;,
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 1,
           &#39;sklearn_classifier&#39;: MLPClassifier(activation=&#39;tanh&#39;, alpha=0.0001363185819149026, beta_1=0.999,
              beta_2=0.9, early_stopping=True,
              hidden_layer_sizes=(115, 115, 115),
              learning_rate_init=0.00018009776276177523, max_iter=32,
              n_iter_no_change=32, random_state=1, verbose=0, warm_start=True)},
    6: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7f3f03d0&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c77444850&gt;,
           &#39;ensemble_weight&#39;: 0.12,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7f3f0820&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 2,
           &#39;sklearn_classifier&#39;: MLPClassifier(alpha=0.0017940473175767063, beta_1=0.999, beta_2=0.9,
              early_stopping=True, hidden_layer_sizes=(101, 101),
              learning_rate_init=0.0004684917334431039, max_iter=32,
              n_iter_no_change=32, random_state=1, verbose=0, warm_start=True)},
    7: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c934610&gt;,
           &#39;cost&#39;: 0.014184397163120588,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c784076a0&gt;,
           &#39;ensemble_weight&#39;: 0.34,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7be7ebb0&gt;,
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 6,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(max_features=34, min_samples_leaf=3, min_samples_split=11,
                     n_estimators=512, n_jobs=1, random_state=1,
                     warm_start=True)},
    8: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7ef850a0&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c6f4e5070&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d6855e0&gt;,
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 7,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=3, min_samples_leaf=2, n_estimators=512,
                       n_jobs=1, random_state=1, warm_start=True)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.985816
  Number of target algorithm runs: 18
  Number of successful target algorithm runs: 18
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 0
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.958041958041958
</pre></div>
</div>
</div>
<div class="section" id="mixed-budget-approach">
<h2>Mixed budget approach<a class="headerlink" href="#mixed-budget-approach" title="Permalink to this headline">¶</a></h2>
<p>Finally, there’s a mixed budget type which uses iterations where possible and
subsamples otherwise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/autosklearn_sh_example_tmp_04&quot;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># &#39;holdout&#39; with &#39;train_size&#39;=0.67 is the default argument setting</span>
    <span class="c1"># for AutoSklearnClassifier. It is explicitly specified in this example</span>
    <span class="c1"># for demonstrational purpose.</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s2">&quot;holdout&quot;</span><span class="p">,</span>
    <span class="n">resampling_strategy_arguments</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train_size&quot;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">},</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;classifier&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;extra_trees&quot;</span><span class="p">,</span> <span class="s2">&quot;gradient_boosting&quot;</span><span class="p">,</span> <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span> <span class="s2">&quot;sgd&quot;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s2">&quot;mixed&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;breast_cancer&quot;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:153: UserWarning: SuccessiveHalving is executed with 1 workers only. Consider to use pynisher to use all available workers.
  warnings.warn(
{   2: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7be7ebe0&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d0b0a00&gt;,
           &#39;ensemble_weight&#39;: 0.1,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7be7e0a0&gt;,
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 1,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
    4: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c729d2fd0&gt;,
           &#39;cost&#39;: 0.014184397163120588,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c774603d0&gt;,
           &#39;ensemble_weight&#39;: 0.24,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c163f10&gt;,
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(max_features=34, min_samples_leaf=3, min_samples_split=11,
                     n_estimators=512, n_jobs=1, random_state=1,
                     warm_start=True)},
    6: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7775d250&gt;,
           &#39;cost&#39;: 0.04255319148936165,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7f06c7c0&gt;,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7bf04190&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 6,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(max_features=9, min_samples_split=10, n_estimators=64,
                     n_jobs=1, random_state=1, warm_start=True)},
    8: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c1fd250&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c73d87760&gt;,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7cd74520&gt;,
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 7,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
    9: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c934850&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c78407610&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7ca60040&gt;,
           &#39;model_id&#39;: 9,
           &#39;rank&#39;: 8,
           &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=0.005326508887463406,
                               learning_rate=0.060800813211425456, max_iter=64,
                               max_leaf_nodes=6, min_samples_leaf=5,
                               n_iter_no_change=5, random_state=1,
                               validation_fraction=None, warm_start=True)},
    11: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7ce45370&gt;,
            &#39;cost&#39;: 0.021276595744680882,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7d6b9e50&gt;,
            &#39;ensemble_weight&#39;: 0.3,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7ce45760&gt;,
            &#39;model_id&#39;: 11,
            &#39;rank&#39;: 9,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.387912939529945e-10,
                               learning_rate=0.30755227194768237, max_iter=64,
                               max_leaf_nodes=60, min_samples_leaf=39,
                               n_iter_no_change=18, random_state=1,
                               validation_fraction=None, warm_start=True)},
    14: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7d094670&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7ef8aa30&gt;,
            &#39;ensemble_weight&#39;: 0.1,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7d094b80&gt;,
            &#39;model_id&#39;: 14,
            &#39;rank&#39;: 10,
            &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=448, min_samples_leaf=2,
                     min_samples_split=20, n_estimators=64, n_jobs=1,
                     random_state=1, warm_start=True)},
    15: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7c162a30&gt;,
            &#39;cost&#39;: 0.021276595744680882,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7cef5d30&gt;,
            &#39;ensemble_weight&#39;: 0.0,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c1621f0&gt;,
            &#39;model_id&#39;: 15,
            &#39;rank&#39;: 11,
            &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=4, min_samples_leaf=2,
                     min_samples_split=15, n_estimators=128, n_jobs=1,
                     random_state=1, warm_start=True)},
    16: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f9c7f129850&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f9c7bf626a0&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f9c7c4283d0&gt;,
            &#39;model_id&#39;: 16,
            &#39;rank&#39;: 12,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=8.057778875694463e-05,
                               learning_rate=0.09179220974965213, max_iter=64,
                               max_leaf_nodes=200, n_iter_no_change=18,
                               random_state=1,
                               validation_fraction=0.14295295806077554,
                               warm_start=True)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.985816
  Number of target algorithm runs: 22
  Number of successful target algorithm runs: 21
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 1
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.9440559440559441
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 3 minutes  27.638 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-60-search-example-successive-halving-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/automl/auto-sklearn/master?urlpath=lab/tree/notebooks/examples/60_search/example_successive_halving.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo2.svg" width="150px" /></a>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/54625156807f9d21fa14b78034b1df5c/example_successive_halving.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">example_successive_halving.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ce2e8ffc7b9780e0d18638781ffd952b/example_successive_halving.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">example_successive_halving.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/examples/60_search/example_successive_halving.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2014-2022, Machine Learning Professorship Freiburg.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>
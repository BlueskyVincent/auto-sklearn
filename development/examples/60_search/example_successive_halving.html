<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Successive Halving &#8212; AutoSklearn 0.14.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>
  
  <a href="https://github.com/automl/auto-sklearn"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          auto-sklearn</a>
        <span class="navbar-text navbar-version pull-left"><b>0.14.3</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../index.html">Start</a></li>
                <li><a href="../../releases.html">Releases</a></li>
                <li><a href="../../installation.html">Installation</a></li>
                <li><a href="../index.html">Examples</a></li>
                <li><a href="../../api.html">API</a></li>
                <li><a href="../../extending.html">Extending</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Successive Halving</a><ul>
<li><a class="reference internal" href="#define-a-callback-that-instantiates-successivehalving">Define a callback that instantiates SuccessiveHalving</a></li>
<li><a class="reference internal" href="#data-loading">Data Loading</a></li>
<li><a class="reference internal" href="#build-and-fit-a-classifier">Build and fit a classifier</a></li>
<li><a class="reference internal" href="#we-can-also-use-cross-validation-with-successive-halving">We can also use cross-validation with successive halving</a></li>
<li><a class="reference internal" href="#use-an-iterative-fit-cross-validation-with-successive-halving">Use an iterative fit cross-validation with successive halving</a></li>
<li><a class="reference internal" href="#next-we-see-the-use-of-subsampling-as-a-budget-in-auto-sklearn">Next, we see the use of subsampling as a budget in Auto-sklearn</a></li>
<li><a class="reference internal" href="#mixed-budget-approach">Mixed budget approach</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-60-search-example-successive-halving-py"><span class="std std-ref">here</span></a>
to download the full example code or to run this example in your browser via Binder</p>
</div>
<div class="sphx-glr-example-title section" id="successive-halving">
<span id="sphx-glr-examples-60-search-example-successive-halving-py"></span><h1>Successive Halving<a class="headerlink" href="#successive-halving" title="Permalink to this headline">¶</a></h1>
<p>This advanced  example illustrates how to interact with
the SMAC callback and get relevant information from the run, like
the number of iterations. Particularly, it exemplifies how to select
the intensification strategy to use in smac, in this case:
<a class="reference external" href="http://proceedings.mlr.press/v80/falkner18a/falkner18a-supp.pdf">SuccessiveHalving</a>.</p>
<p>This results in an adaptation of the <a class="reference external" href="http://proceedings.mlr.press/v80/falkner18a/falkner18a.pdf">BOHB algorithm</a>.
It uses Successive Halving instead of <a class="reference external" href="https://jmlr.org/papers/volume18/16-558/16-558.pdf">Hyperband</a>, and could be abbreviated as BOSH.
To get the BOHB algorithm, simply import Hyperband and use it as the intensification strategy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="kn">import</span> <span class="nn">sklearn.model_selection</span>
<span class="kn">import</span> <span class="nn">sklearn.datasets</span>
<span class="kn">import</span> <span class="nn">sklearn.metrics</span>

<span class="kn">import</span> <span class="nn">autosklearn.classification</span>
</pre></div>
</div>
<div class="section" id="define-a-callback-that-instantiates-successivehalving">
<h2>Define a callback that instantiates SuccessiveHalving<a class="headerlink" href="#define-a-callback-that-instantiates-successivehalving" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_smac_object_callback</span><span class="p">(</span><span class="n">budget_type</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_smac_object</span><span class="p">(</span>
        <span class="n">scenario_dict</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">,</span>
        <span class="n">ta</span><span class="p">,</span>
        <span class="n">ta_kwargs</span><span class="p">,</span>
        <span class="n">metalearning_configurations</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">dask_client</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="kn">from</span> <span class="nn">smac.facade.smac_ac_facade</span> <span class="kn">import</span> <span class="n">SMAC4AC</span>
        <span class="kn">from</span> <span class="nn">smac.intensification.successive_halving</span> <span class="kn">import</span> <span class="n">SuccessiveHalving</span>
        <span class="kn">from</span> <span class="nn">smac.runhistory.runhistory2epm</span> <span class="kn">import</span> <span class="n">RunHistory2EPM4LogCost</span>
        <span class="kn">from</span> <span class="nn">smac.scenario.scenario</span> <span class="kn">import</span> <span class="n">Scenario</span>

        <span class="k">if</span> <span class="n">n_jobs</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dask_client</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">dask_client</span><span class="o">.</span><span class="n">nthreads</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please make sure to guard the code invoking Auto-sklearn by &quot;</span>
                             <span class="s2">&quot;`if __name__ == &#39;__main__&#39;` and remove this exception.&quot;</span><span class="p">)</span>

        <span class="n">scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="n">scenario_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">metalearning_configurations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">default_config</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">get_default_configuration</span><span class="p">()</span>
            <span class="n">initial_configurations</span> <span class="o">=</span> <span class="p">[</span><span class="n">default_config</span><span class="p">]</span> <span class="o">+</span> <span class="n">metalearning_configurations</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initial_configurations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">rh2EPM</span> <span class="o">=</span> <span class="n">RunHistory2EPM4LogCost</span>

        <span class="n">ta_kwargs</span><span class="p">[</span><span class="s1">&#39;budget_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">budget_type</span>

        <span class="k">return</span> <span class="n">SMAC4AC</span><span class="p">(</span>
            <span class="n">scenario</span><span class="o">=</span><span class="n">scenario</span><span class="p">,</span>
            <span class="n">rng</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="n">runhistory2epm</span><span class="o">=</span><span class="n">rh2EPM</span><span class="p">,</span>
            <span class="n">tae_runner</span><span class="o">=</span><span class="n">ta</span><span class="p">,</span>
            <span class="n">tae_runner_kwargs</span><span class="o">=</span><span class="n">ta_kwargs</span><span class="p">,</span>
            <span class="n">initial_configurations</span><span class="o">=</span><span class="n">initial_configurations</span><span class="p">,</span>
            <span class="n">run_id</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="n">intensifier</span><span class="o">=</span><span class="n">SuccessiveHalving</span><span class="p">,</span>
            <span class="n">intensifier_kwargs</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;initial_budget&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
                <span class="s1">&#39;max_budget&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;min_chall&#39;</span><span class="p">:</span> <span class="mi">1</span>
            <span class="p">},</span>
            <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
            <span class="n">dask_client</span><span class="o">=</span><span class="n">dask_client</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">get_smac_object</span>
</pre></div>
</div>
</div>
<div class="section" id="data-loading">
<h2>Data Loading<a class="headerlink" href="#data-loading" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> \
    <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="build-and-fit-a-classifier">
<h2>Build and fit a classifier<a class="headerlink" href="#build-and-fit-a-classifier" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s1">&#39;/tmp/autosklearn_sh_example_tmp&#39;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># &#39;holdout&#39; with &#39;train_size&#39;=0.67 is the default argument setting</span>
    <span class="c1"># for AutoSklearnClassifier. It is explicitly specified in this example</span>
    <span class="c1"># for demonstrational purpose.</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s1">&#39;holdout&#39;</span><span class="p">,</span>
    <span class="n">resampling_strategy_arguments</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;train_size&#39;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">},</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;classifier&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;extra_trees&#39;</span><span class="p">,</span> <span class="s1">&#39;gradient_boosting&#39;</span><span class="p">,</span> <span class="s1">&#39;random_forest&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sgd&#39;</span><span class="p">,</span> <span class="s1">&#39;passive_aggressive&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;feature_preprocessor&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;no_preprocessing&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s1">&#39;iterations&#39;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;breast_cancer&#39;</span><span class="p">)</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:152: UserWarning: SuccessiveHalving is intended to be used with more than 1 worker but num_workers=1
  warnings.warn(&quot;{} is intended to be used &quot;
{   3: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833cf73400&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f834283b7c0&gt;,
           &#39;ensemble_weight&#39;: 0.08,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8344327730&gt;,
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 7,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
    4: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f83264f6520&gt;,
           &#39;cost&#39;: 0.07801418439716312,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833af41280&gt;,
           &#39;ensemble_weight&#39;: 0.18,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f83264f6220&gt;,
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 17,
           &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
    5: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833a7f2e20&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833d21ca00&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833a7f2f40&gt;,
           &#39;model_id&#39;: 5,
           &#39;rank&#39;: 8,
           &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
    6: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833c713640&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8342816ca0&gt;,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833c713400&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 9,
           &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
    7: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f83440911f0&gt;,
           &#39;cost&#39;: 0.03546099290780147,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833c6f93a0&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833cc2f070&gt;,
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 12,
           &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
    8: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833cfa3fd0&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833a7e1340&gt;,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f834052efd0&gt;,
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=512, n_jobs=1,
                       random_state=1, warm_start=True)},
    9: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8342824d30&gt;,
           &#39;cost&#39;: 0.014184397163120588,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833ce3a3d0&gt;,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8343e53850&gt;,
           &#39;model_id&#39;: 9,
           &#39;rank&#39;: 2,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=64, n_jobs=1, random_state=1,
                     warm_start=True)},
    10: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8340783ee0&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f834078fac0&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8340783040&gt;,
            &#39;model_id&#39;: 10,
            &#39;rank&#39;: 10,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=5.027708640006448e-08,
                               learning_rate=0.09750328007832798, max_iter=64,
                               max_leaf_nodes=1234, min_samples_leaf=25,
                               n_iter_no_change=1, random_state=1,
                               validation_fraction=0.08300813783286698,
                               warm_start=True)},
    11: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833cc90970&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b1eec10&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833cc90220&gt;,
            &#39;model_id&#39;: 11,
            &#39;rank&#39;: 11,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False,
                               l2_regularization=1.0945814167023392e-10,
                               learning_rate=0.11042628136263043, max_iter=128,
                               max_leaf_nodes=30, min_samples_leaf=22,
                               n_iter_no_change=0, random_state=1,
                               validation_fraction=None, warm_start=True)},
    13: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833c6bf370&gt;,
            &#39;cost&#39;: 0.03546099290780147,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83428b7ee0&gt;,
            &#39;ensemble_weight&#39;: 0.06,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833c6bf7f0&gt;,
            &#39;model_id&#39;: 13,
            &#39;rank&#39;: 13,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=2.506856350040198e-06,
                               learning_rate=0.04634380160611007, max_iter=64,
                               max_leaf_nodes=11, min_samples_leaf=41,
                               n_iter_no_change=17, random_state=1,
                               validation_fraction=None, warm_start=True)},
    14: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833c4c3af0&gt;,
            &#39;cost&#39;: 0.03546099290780147,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f834275c700&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833c4c3970&gt;,
            &#39;model_id&#39;: 14,
            &#39;rank&#39;: 14,
            &#39;sklearn_classifier&#39;: ExtraTreesClassifier(bootstrap=True, max_features=3, min_samples_leaf=2,
                     min_samples_split=3, n_estimators=64, n_jobs=1,
                     random_state=1, warm_start=True)},
    15: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833af2bfa0&gt;,
            &#39;cost&#39;: 0.049645390070921946,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8342848910&gt;,
            &#39;ensemble_weight&#39;: 0.02,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833af2bca0&gt;,
            &#39;model_id&#39;: 15,
            &#39;rank&#39;: 15,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False,
                               l2_regularization=0.0005657707133726288,
                               learning_rate=0.09546265146045475, max_iter=64,
                               max_leaf_nodes=109, min_samples_leaf=2,
                               n_iter_no_change=0, random_state=1,
                               validation_fraction=None, warm_start=True)},
    16: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833b7d4070&gt;,
            &#39;cost&#39;: 0.049645390070921946,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83269470a0&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8326331eb0&gt;,
            &#39;model_id&#39;: 16,
            &#39;rank&#39;: 16,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=12,
                       min_samples_leaf=15, min_samples_split=6,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
    17: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f83340798b0&gt;,
            &#39;cost&#39;: 0.099290780141844,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8326334820&gt;,
            &#39;ensemble_weight&#39;: 0.02,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833407bf70&gt;,
            &#39;model_id&#39;: 17,
            &#39;rank&#39;: 18,
            &#39;sklearn_classifier&#39;: SGDClassifier(alpha=9.410144741041167e-05, average=True,
              eta0=0.0018055343233337954, learning_rate=&#39;constant&#39;, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=0.05082904256838701, warm_start=True)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.985816
  Number of target algorithm runs: 20
  Number of successful target algorithm runs: 20
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 0
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.951048951048951
</pre></div>
</div>
</div>
<div class="section" id="we-can-also-use-cross-validation-with-successive-halving">
<h2>We can also use cross-validation with successive halving<a class="headerlink" href="#we-can-also-use-cross-validation-with-successive-halving" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> \
    <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s1">&#39;/tmp/autosklearn_sh_example_tmp_01&#39;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s1">&#39;cv&#39;</span><span class="p">,</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;classifier&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;extra_trees&#39;</span><span class="p">,</span> <span class="s1">&#39;gradient_boosting&#39;</span><span class="p">,</span> <span class="s1">&#39;random_forest&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sgd&#39;</span><span class="p">,</span> <span class="s1">&#39;passive_aggressive&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;feature_preprocessor&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;no_preprocessing&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s1">&#39;iterations&#39;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;breast_cancer&#39;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">refit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:152: UserWarning: SuccessiveHalving is intended to be used with more than 1 worker but num_workers=1
  warnings.warn(&quot;{} is intended to be used &quot;
{   2: {   &#39;cost&#39;: 0.046948356807511755,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833a681880&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83427b7940&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833a681160&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8326b786d0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83263c1760&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8326b785e0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833b137fd0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833ab38ac0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833b137e80&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833c0a8ee0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833c5564f0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833c0a8e20&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833bf5fbb0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833bf4a1c0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833bf5faf0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)}],
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 5,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    3: {   &#39;cost&#39;: 0.05164319248826292,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8326b5fd00&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8326589430&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8326b5f610&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8326693b80&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833c711af0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8326693a60&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833bc3fa30&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833bc4b040&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833bc3f970&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f834085d700&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b835cd0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f834085d640&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833ab0c3d0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b8e29a0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833ab0c310&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=23, min_samples_leaf=7,
                       n_estimators=64, n_jobs=1, random_state=1,
                       warm_start=True)}],
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 7,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    4: {   &#39;cost&#39;: 0.08215962441314555,
           &#39;ensemble_weight&#39;: 0.3,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8326465580&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833bfee580&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833ab382b0&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833bc3f460&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b97aaf0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833bc3f220&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833be8efd0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f834085d310&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833be8eeb0&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833ba1cac0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8334247160&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833ba1c7f0&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8340065e50&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83400604f0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8340065d90&gt;,
                                 &#39;sklearn_classifier&#39;: PassiveAggressiveClassifier(C=0.14268277711454813, max_iter=128, random_state=1,
                            tol=0.0002600768160857831, warm_start=True)}],
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 8,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    5: {   &#39;cost&#39;: 0.035211267605633804,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833b1eee50&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f832694ab50&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833b1eedc0&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8326511220&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833a8d4460&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8326511ca0&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f83427e4c70&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833a681b80&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f83427e4940&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833ab3e2e0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833bca23d0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833ab3ebe0&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833cf396a0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8340b0a640&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833cf395b0&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False, l2_regularization=1e-10,
                               learning_rate=0.16262682406125173, max_iter=64,
                               max_leaf_nodes=66, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)}],
           &#39;model_id&#39;: 5,
           &#39;rank&#39;: 2,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    6: {   &#39;cost&#39;: 0.04694835680751174,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833407b130&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833f77f3d0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833405f8e0&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f832674fa60&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b1378b0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f832674f970&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833b95aee0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83341fdfa0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833b95adc0&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8326165e20&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833c25e460&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8326165d60&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833bd89b80&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833bd7b1c0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833bd89ac0&gt;,
                                 &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.609412172481434e-10,
                               learning_rate=0.05972079854295879, max_iter=64,
                               max_leaf_nodes=4, min_samples_leaf=2,
                               n_iter_no_change=14, random_state=1,
                               validation_fraction=None, warm_start=True)}],
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 6,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    7: {   &#39;cost&#39;: 0.035211267605633784,
           &#39;ensemble_weight&#39;: 0.14,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8343efb490&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833c0652e0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8343efbf70&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833ff39bb0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833c719b20&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833ff39040&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833407be80&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8340b0ad90&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833405f460&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8340a1d490&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b5d4a60&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8340a1d3d0&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f83266498b0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8334099e80&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f83266497f0&gt;,
                                 &#39;sklearn_classifier&#39;: SGDClassifier(alpha=0.0002346515712987664, average=True, eta0=0.01, loss=&#39;log&#39;,
              max_iter=128, penalty=&#39;l1&#39;, random_state=1,
              tol=1.3716748930467322e-05, warm_start=True)}],
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 3,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    8: {   &#39;cost&#39;: 0.039906103286385,
           &#39;ensemble_weight&#39;: 0.2,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833cf73e50&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83265a5f10&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833cf73760&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8340a1d970&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b5bf1c0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8340a1d880&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f83263c1ee0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833bc6d4f0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f83263c1e20&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833bd58bb0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b2d31c0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833bd58af0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8326471880&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833ab38e50&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f83264717c0&gt;,
                                 &#39;sklearn_classifier&#39;: RandomForestClassifier(bootstrap=False, criterion=&#39;entropy&#39;, max_features=4,
                       min_samples_split=4, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)}],
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 4,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)},
    9: {   &#39;cost&#39;: 0.028169014084507022,
           &#39;ensemble_weight&#39;: 0.16,
           &#39;estimators&#39;: [   {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f832611afa0&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b883370&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f832611a520&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=64, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8344108580&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83428f41f0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f83441086d0&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=64, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833a8d4430&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83405f6f40&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833a8d4a60&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=64, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f83440a3b80&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f834090e9a0&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f83440a3e50&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=64, n_jobs=1, random_state=1,
                     warm_start=True)},
                             {   &#39;balancing&#39;: Balancing(random_state=1),
                                 &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8340076c70&gt;,
                                 &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833a681940&gt;,
                                 &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8340076760&gt;,
                                 &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=8, min_samples_split=3,
                     n_estimators=64, n_jobs=1, random_state=1,
                     warm_start=True)}],
           &#39;model_id&#39;: 9,
           &#39;rank&#39;: 1,
           &#39;voting_model&#39;: VotingClassifier(estimators=None, voting=&#39;soft&#39;)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.971831
  Number of target algorithm runs: 9
  Number of successful target algorithm runs: 8
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 1
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.965034965034965
</pre></div>
</div>
</div>
<div class="section" id="use-an-iterative-fit-cross-validation-with-successive-halving">
<h2>Use an iterative fit cross-validation with successive halving<a class="headerlink" href="#use-an-iterative-fit-cross-validation-with-successive-halving" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> \
    <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s1">&#39;/tmp/autosklearn_sh_example_tmp_cv_02&#39;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s1">&#39;cv-iterative-fit&#39;</span><span class="p">,</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;classifier&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;extra_trees&#39;</span><span class="p">,</span> <span class="s1">&#39;gradient_boosting&#39;</span><span class="p">,</span> <span class="s1">&#39;random_forest&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sgd&#39;</span><span class="p">,</span> <span class="s1">&#39;passive_aggressive&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;feature_preprocessor&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;no_preprocessing&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s1">&#39;iterations&#39;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;breast_cancer&#39;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">refit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:152: UserWarning: SuccessiveHalving is intended to be used with more than 1 worker but num_workers=1
  warnings.warn(&quot;{} is intended to be used &quot;
{   2: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f832646dbe0&gt;,
           &#39;cost&#39;: 0.046948356807511755,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83428f4fd0&gt;,
           &#39;ensemble_weight&#39;: 0.12,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f832646d430&gt;,
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 3,
           &#39;sklearn_classifier&#39;: None},
    3: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833a7f2580&gt;,
           &#39;cost&#39;: 0.05164319248826292,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833a7e1340&gt;,
           &#39;ensemble_weight&#39;: 0.1,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833a7f22e0&gt;,
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: None},
    4: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833cf39c40&gt;,
           &#39;cost&#39;: 0.11267605633802817,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83427b74f0&gt;,
           &#39;ensemble_weight&#39;: 0.22,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8343e8a520&gt;,
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 6,
           &#39;sklearn_classifier&#39;: None},
    5: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8343efbf70&gt;,
           &#39;cost&#39;: 0.035211267605633804,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b137b50&gt;,
           &#39;ensemble_weight&#39;: 0.14,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8343efb8b0&gt;,
           &#39;model_id&#39;: 5,
           &#39;rank&#39;: 1,
           &#39;sklearn_classifier&#39;: None},
    6: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8343e53460&gt;,
           &#39;cost&#39;: 0.04694835680751174,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f834285bf70&gt;,
           &#39;ensemble_weight&#39;: 0.16,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8344175520&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 4,
           &#39;sklearn_classifier&#39;: None},
    7: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833c6d36d0&gt;,
           &#39;cost&#39;: 0.0352112676056338,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f835f7314c0&gt;,
           &#39;ensemble_weight&#39;: 0.26,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833b137dc0&gt;,
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 2,
           &#39;sklearn_classifier&#39;: None}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.964789
  Number of target algorithm runs: 6
  Number of successful target algorithm runs: 6
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 0
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.965034965034965
</pre></div>
</div>
</div>
<div class="section" id="next-we-see-the-use-of-subsampling-as-a-budget-in-auto-sklearn">
<h2>Next, we see the use of subsampling as a budget in Auto-sklearn<a class="headerlink" href="#next-we-see-the-use-of-subsampling-as-a-budget-in-auto-sklearn" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> \
    <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s1">&#39;/tmp/autosklearn_sh_example_tmp_03&#39;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># &#39;holdout&#39; with &#39;train_size&#39;=0.67 is the default argument setting</span>
    <span class="c1"># for AutoSklearnClassifier. It is explicitly specified in this example</span>
    <span class="c1"># for demonstrational purpose.</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s1">&#39;holdout&#39;</span><span class="p">,</span>
    <span class="n">resampling_strategy_arguments</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;train_size&#39;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s1">&#39;subsample&#39;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;breast_cancer&#39;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:152: UserWarning: SuccessiveHalving is intended to be used with more than 1 worker but num_workers=1
  warnings.warn(&quot;{} is intended to be used &quot;
{   2: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f832679ab20&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833b5f6370&gt;,
           &#39;ensemble_weight&#39;: 0.02,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f832679a760&gt;,
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=512, n_jobs=1,
                       random_state=1, warm_start=True)},
    3: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8326a9d820&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833ce3a3d0&gt;,
           &#39;ensemble_weight&#39;: 0.24,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8326a9d370&gt;,
           &#39;model_id&#39;: 3,
           &#39;rank&#39;: 2,
           &#39;sklearn_classifier&#39;: MLPClassifier(activation=&#39;tanh&#39;, alpha=0.0001363185819149026, beta_1=0.999,
              beta_2=0.9, early_stopping=True,
              hidden_layer_sizes=(115, 115, 115),
              learning_rate_init=0.00018009776276177523, max_iter=32,
              n_iter_no_change=32, random_state=1, verbose=0, warm_start=True)},
    5: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833a6f06d0&gt;,
           &#39;cost&#39;: 0.03546099290780147,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833cb5cac0&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833c6f9fd0&gt;,
           &#39;model_id&#39;: 5,
           &#39;rank&#39;: 9,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=3, min_samples_leaf=2,
                       n_estimators=512, n_jobs=1, random_state=1,
                       warm_start=True)},
    6: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833b1ee0d0&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8326511850&gt;,
           &#39;ensemble_weight&#39;: 0.22,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833b1ee0a0&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 3,
           &#39;sklearn_classifier&#39;: MLPClassifier(alpha=0.0017940473175767063, beta_1=0.999, beta_2=0.9,
              early_stopping=True, hidden_layer_sizes=(101, 101),
              learning_rate_init=0.0004684917334431039, max_iter=32,
              n_iter_no_change=32, random_state=1, verbose=0, warm_start=True)},
    7: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f83440a34f0&gt;,
           &#39;cost&#39;: 0.014184397163120588,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8326230b50&gt;,
           &#39;ensemble_weight&#39;: 0.08,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8340cf2f10&gt;,
           &#39;model_id&#39;: 7,
           &#39;rank&#39;: 6,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(max_features=34, min_samples_leaf=3, min_samples_split=11,
                     n_estimators=512, n_jobs=1, random_state=1,
                     warm_start=True)},
    8: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833bcbad30&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8326947460&gt;,
           &#39;ensemble_weight&#39;: 0.08,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833bade0a0&gt;,
           &#39;model_id&#39;: 8,
           &#39;rank&#39;: 7,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=3, min_samples_leaf=2, n_estimators=512,
                       n_jobs=1, random_state=1, warm_start=True)},
    10: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833bcba1f0&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833d2ec2b0&gt;,
            &#39;ensemble_weight&#39;: 0.04,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833bcba910&gt;,
            &#39;model_id&#39;: 10,
            &#39;rank&#39;: 8,
            &#39;sklearn_classifier&#39;: RandomForestClassifier(criterion=&#39;entropy&#39;, max_features=4, min_samples_split=6,
                       n_estimators=512, n_jobs=1, random_state=1,
                       warm_start=True)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.985816
  Number of target algorithm runs: 12
  Number of successful target algorithm runs: 12
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 0
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.958041958041958
</pre></div>
</div>
</div>
<div class="section" id="mixed-budget-approach">
<h2>Mixed budget approach<a class="headerlink" href="#mixed-budget-approach" title="Permalink to this headline">¶</a></h2>
<p>Finally, there’s a mixed budget type which uses iterations where possible and
subsamples otherwise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> \
    <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">automl</span> <span class="o">=</span> <span class="n">autosklearn</span><span class="o">.</span><span class="n">classification</span><span class="o">.</span><span class="n">AutoSklearnClassifier</span><span class="p">(</span>
    <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">per_run_time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">tmp_folder</span><span class="o">=</span><span class="s1">&#39;/tmp/autosklearn_sh_example_tmp_04&#39;</span><span class="p">,</span>
    <span class="n">disable_evaluator_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># &#39;holdout&#39; with &#39;train_size&#39;=0.67 is the default argument setting</span>
    <span class="c1"># for AutoSklearnClassifier. It is explicitly specified in this example</span>
    <span class="c1"># for demonstrational purpose.</span>
    <span class="n">resampling_strategy</span><span class="o">=</span><span class="s1">&#39;holdout&#39;</span><span class="p">,</span>
    <span class="n">resampling_strategy_arguments</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;train_size&#39;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">},</span>
    <span class="n">include</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;classifier&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;extra_trees&#39;</span><span class="p">,</span> <span class="s1">&#39;gradient_boosting&#39;</span><span class="p">,</span> <span class="s1">&#39;random_forest&#39;</span><span class="p">,</span> <span class="s1">&#39;sgd&#39;</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="n">get_smac_object_callback</span><span class="o">=</span><span class="n">get_smac_object_callback</span><span class="p">(</span><span class="s1">&#39;mixed&#39;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;breast_cancer&#39;</span><span class="p">)</span>

<span class="c1"># Print the final ensemble constructed by auto-sklearn.</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">show_models</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># Print statistics about the auto-sklearn run such as number of</span>
<span class="c1"># iterations, number of models failed with a time out.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">automl</span><span class="o">.</span><span class="n">sprint_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy score&quot;</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/smac/intensification/parallel_scheduling.py:152: UserWarning: SuccessiveHalving is intended to be used with more than 1 worker but num_workers=1
  warnings.warn(&quot;{} is intended to be used &quot;
{   2: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833c0657c0&gt;,
           &#39;cost&#39;: 0.021276595744680882,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8340ad4bb0&gt;,
           &#39;ensemble_weight&#39;: 0.1,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833c0656a0&gt;,
           &#39;model_id&#39;: 2,
           &#39;rank&#39;: 5,
           &#39;sklearn_classifier&#39;: RandomForestClassifier(max_features=5, n_estimators=64, n_jobs=1,
                       random_state=1, warm_start=True)},
    4: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833f77f7c0&gt;,
           &#39;cost&#39;: 0.014184397163120588,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f834275cb20&gt;,
           &#39;ensemble_weight&#39;: 0.14,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833f77f760&gt;,
           &#39;model_id&#39;: 4,
           &#39;rank&#39;: 4,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(max_features=34, min_samples_leaf=3, min_samples_split=11,
                     n_estimators=512, n_jobs=1, random_state=1,
                     warm_start=True)},
    6: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833bcba190&gt;,
           &#39;cost&#39;: 0.04255319148936165,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83262304c0&gt;,
           &#39;ensemble_weight&#39;: 0.06,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8326970730&gt;,
           &#39;model_id&#39;: 6,
           &#39;rank&#39;: 12,
           &#39;sklearn_classifier&#39;: ExtraTreesClassifier(max_features=9, min_samples_split=10, n_estimators=64,
                     n_jobs=1, random_state=1, warm_start=True)},
    9: {   &#39;balancing&#39;: Balancing(random_state=1),
           &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f83268dee50&gt;,
           &#39;cost&#39;: 0.028368794326241176,
           &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833c30ad00&gt;,
           &#39;ensemble_weight&#39;: 0.04,
           &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8326218c40&gt;,
           &#39;model_id&#39;: 9,
           &#39;rank&#39;: 8,
           &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=0.005326508887463406,
                               learning_rate=0.060800813211425456, max_iter=64,
                               max_leaf_nodes=6, min_samples_leaf=5,
                               n_iter_no_change=5, random_state=1,
                               validation_fraction=None, warm_start=True)},
    10: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8326a9dac0&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8326511280&gt;,
            &#39;ensemble_weight&#39;: 0.02,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f8326a9d400&gt;,
            &#39;model_id&#39;: 10,
            &#39;rank&#39;: 9,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=False,
                               l2_regularization=1.0647401999412075e-10,
                               learning_rate=0.08291320147381159, max_iter=64,
                               max_leaf_nodes=39, n_iter_no_change=0,
                               random_state=1, validation_fraction=None,
                               warm_start=True)},
    11: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833d2ec730&gt;,
            &#39;cost&#39;: 0.021276595744680882,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f8340322610&gt;,
            &#39;ensemble_weight&#39;: 0.26,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833d2ec610&gt;,
            &#39;model_id&#39;: 11,
            &#39;rank&#39;: 6,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=3.387912939529945e-10,
                               learning_rate=0.30755227194768237, max_iter=64,
                               max_leaf_nodes=60, min_samples_leaf=39,
                               n_iter_no_change=18, random_state=1,
                               validation_fraction=None, warm_start=True)},
    14: {   &#39;balancing&#39;: Balancing(random_state=1, strategy=&#39;weighting&#39;),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f83265c8820&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f833cbf8e80&gt;,
            &#39;ensemble_weight&#39;: 0.02,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f83265c85b0&gt;,
            &#39;model_id&#39;: 14,
            &#39;rank&#39;: 10,
            &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=448, min_samples_leaf=2,
                     min_samples_split=20, n_estimators=64, n_jobs=1,
                     random_state=1, warm_start=True)},
    15: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f833a8a6850&gt;,
            &#39;cost&#39;: 0.021276595744680882,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f834078f790&gt;,
            &#39;ensemble_weight&#39;: 0.02,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833ce3a1f0&gt;,
            &#39;model_id&#39;: 15,
            &#39;rank&#39;: 7,
            &#39;sklearn_classifier&#39;: ExtraTreesClassifier(criterion=&#39;entropy&#39;, max_features=4, min_samples_leaf=2,
                     min_samples_split=15, n_estimators=64, n_jobs=1,
                     random_state=1, warm_start=True)},
    16: {   &#39;balancing&#39;: Balancing(random_state=1),
            &#39;classifier&#39;: &lt;autosklearn.pipeline.components.classification.ClassifierChoice object at 0x7f8340a29b20&gt;,
            &#39;cost&#39;: 0.028368794326241176,
            &#39;data_preprocessor&#39;: &lt;autosklearn.pipeline.components.data_preprocessing.DataPreprocessorChoice object at 0x7f83407836a0&gt;,
            &#39;ensemble_weight&#39;: 0.02,
            &#39;feature_preprocessor&#39;: &lt;autosklearn.pipeline.components.feature_preprocessing.FeaturePreprocessorChoice object at 0x7f833be824c0&gt;,
            &#39;model_id&#39;: 16,
            &#39;rank&#39;: 11,
            &#39;sklearn_classifier&#39;: HistGradientBoostingClassifier(early_stopping=True,
                               l2_regularization=8.057778875694463e-05,
                               learning_rate=0.09179220974965213, max_iter=64,
                               max_leaf_nodes=200, n_iter_no_change=18,
                               random_state=1,
                               validation_fraction=0.14295295806077554,
                               warm_start=True)}}
auto-sklearn results:
  Dataset name: breast_cancer
  Metric: accuracy
  Best validation score: 0.985816
  Number of target algorithm runs: 18
  Number of successful target algorithm runs: 18
  Number of crashed target algorithm runs: 0
  Number of target algorithms that exceeded the time limit: 0
  Number of target algorithms that exceeded the memory limit: 0

Accuracy score 0.9440559440559441
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 3 minutes  9.009 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-60-search-example-successive-halving-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/automl/auto-sklearn/master?urlpath=lab/tree/notebooks/examples/60_search/example_successive_halving.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo2.svg" width="150px" /></a>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/54625156807f9d21fa14b78034b1df5c/example_successive_halving.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">example_successive_halving.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ce2e8ffc7b9780e0d18638781ffd952b/example_successive_halving.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">example_successive_halving.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/examples/60_search/example_successive_halving.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2014-2022, Machine Learning Professorship Freiburg.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>